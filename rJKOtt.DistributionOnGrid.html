

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>rJKOtt.DistributionOnGrid module &mdash; rJKOtt  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="rJKOtt.TensorTrainSolver module" href="rJKOtt.TensorTrainSolver.html" />
    <link rel="prev" title="rJKOtt package" href="rJKOtt.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            rJKOtt
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">rJKOtt</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="rJKOtt.html">rJKOtt package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="rJKOtt.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">rJKOtt.DistributionOnGrid module</a></li>
<li class="toctree-l4"><a class="reference internal" href="rJKOtt.TensorTrainSolver.html">rJKOtt.TensorTrainSolver module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rJKOtt.html#module-rJKOtt">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="_include/examples.html">Examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">rJKOtt</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">rJKOtt</a></li>
          <li class="breadcrumb-item"><a href="rJKOtt.html">rJKOtt package</a></li>
      <li class="breadcrumb-item active">rJKOtt.DistributionOnGrid module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/rJKOtt.DistributionOnGrid.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-rJKOtt.DistributionOnGrid">
<span id="rjkott-distributionongrid-module"></span><h1>rJKOtt.DistributionOnGrid module<a class="headerlink" href="#module-rJKOtt.DistributionOnGrid" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.DenseArrayDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rJKOtt.DistributionOnGrid.</span></span><span class="sig-name descname"><span class="pre">DenseArrayDistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#DenseArrayDistribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.DenseArrayDistribution" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#rJKOtt.DistributionOnGrid.DistributionOnGrid" title="rJKOtt.DistributionOnGrid.DistributionOnGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistributionOnGrid</span></code></a></p>
<p>Stores the density on the full grid. Run for dim &lt;= 4, or face memory issues</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid</strong> (<a class="reference internal" href="#rJKOtt.DistributionOnGrid.Grid" title="rJKOtt.DistributionOnGrid.Grid"><em>Grid</em></a>) – self-explanatory</p></li>
<li><p><strong>rho</strong> (<em>Callable</em>) – function proportional to the density</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.DenseArrayDistribution.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><a class="headerlink" href="#rJKOtt.DistributionOnGrid.DenseArrayDistribution.dim" title="Link to this definition"></a></dt>
<dd><p>dimension of the distribution</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.DenseArrayDistribution.density">
<span class="sig-name descname"><span class="pre">density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#DenseArrayDistribution.density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.DenseArrayDistribution.density" title="Link to this definition"></a></dt>
<dd><p>Returns a value, proportional to the pdf of the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>np.ndarray</em>) – array of shape <cite>(N_x, dim)</cite> — coordinates of N_x points</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of shape <cite>(N_x)</cite> — value of density (up to normalization constant) at these points</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.DenseArrayDistribution.get_double_moon">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_double_moon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#DenseArrayDistribution.get_double_moon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.DenseArrayDistribution.get_double_moon" title="Link to this definition"></a></dt>
<dd><p>Get a test bimodal distribution of the form</p>
<div class="math notranslate nohighlight">
\[\rho_{ \text{DM}}(x)  \propto  \exp \left( -2( \|x \|_2 - a)^2 \right)  \left(  \exp(-2(x_1 -a)^2) +  \exp(-2(x_1 +a)^2)  \right)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid</strong> (<a class="reference internal" href="#rJKOtt.DistributionOnGrid.Grid" title="rJKOtt.DistributionOnGrid.Grid"><em>Grid</em></a>) – grid</p></li>
<li><p><strong>a</strong> (<em>numpy.float64</em>) – the shift of the distribution (int the first dimension)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#rJKOtt.DistributionOnGrid.DenseArrayDistribution" title="rJKOtt.DistributionOnGrid.DenseArrayDistribution">DenseArrayDistribution</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.DenseArrayDistribution.get_marginal_on_grid">
<span class="sig-name descname"><span class="pre">get_marginal_on_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">marginals</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#DenseArrayDistribution.get_marginal_on_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.DenseArrayDistribution.get_marginal_on_grid" title="Link to this definition"></a></dt>
<dd><p>Returns a density of the marginal distribution of (x_i1 … x_ik), discretized on the associated grid</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only 1 or 2 dimensional marginals supported. Order matters:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_marginal_on_grid</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="n">get_marginal_on_grid</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>marginals</strong> – indices of marginals to compute</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of shape <cite>(grid.N[i])</cite> or <cite>(grid.N[i], grid.N[j])</cite> — density of the marginal distribution of x_i, discretized on the associated grid</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.DenseArrayDistribution.get_nonconvex">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_nonconvex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#DenseArrayDistribution.get_nonconvex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.DenseArrayDistribution.get_nonconvex" title="Link to this definition"></a></dt>
<dd><p>Get a test distribution with nonconvex potential</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\rho_{\text{NC}} \propto \exp(-V_{\text{NC}})\\V_{ \text{NC}}(x) =  \left(  \sum \limits_{i = 1}^3  \sqrt{|x_i - a_i|}  \right)^2\end{aligned}\end{align} \]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid</strong> (<a class="reference internal" href="#rJKOtt.DistributionOnGrid.Grid" title="rJKOtt.DistributionOnGrid.Grid"><em>Grid</em></a>) – grid</p></li>
<li><p><strong>a</strong> (<em>numpy.ndarray</em>) – the shift of the distribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#rJKOtt.DistributionOnGrid.DenseArrayDistribution" title="rJKOtt.DistributionOnGrid.DenseArrayDistribution">DenseArrayDistribution</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.DenseArrayDistribution.log_density">
<span class="sig-name descname"><span class="pre">log_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#DenseArrayDistribution.log_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.DenseArrayDistribution.log_density" title="Link to this definition"></a></dt>
<dd><p>Returns a value, equal to the log pdf of the distribution (up to an additive constant).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>numpy.ndarray</em>) – array of shape <cite>(N_x, dim)</cite> — coordinates of N_x points</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of shape <cite>(N_x)</cite> — value of log density (up to an additive constant) at these points</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.DistributionOnGrid">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rJKOtt.DistributionOnGrid.</span></span><span class="sig-name descname"><span class="pre">DistributionOnGrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#DistributionOnGrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.DistributionOnGrid" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Convenience class for storing distributions and plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>grid</strong> (<a class="reference internal" href="#rJKOtt.DistributionOnGrid.Grid" title="rJKOtt.DistributionOnGrid.Grid"><em>Grid</em></a>) – self-explanatory</p>
</dd>
</dl>
<dl class="simple">
<dt>Attributes :</dt><dd><p>dim : dimension of the distribution</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.DistributionOnGrid.density">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#DistributionOnGrid.density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.DistributionOnGrid.density" title="Link to this definition"></a></dt>
<dd><p>Returns a value, proportional to the pdf of the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>np.ndarray</em>) – array of shape <cite>(N_x, dim)</cite> — coordinates of N_x points</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of shape <cite>(N_x)</cite> — value of density (up to normalization constant) at these points</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.DistributionOnGrid.dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#rJKOtt.DistributionOnGrid.DistributionOnGrid.dim" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.DistributionOnGrid.get_marginal_on_grid">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_marginal_on_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">marginals</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#DistributionOnGrid.get_marginal_on_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.DistributionOnGrid.get_marginal_on_grid" title="Link to this definition"></a></dt>
<dd><p>Returns a density of the marginal distribution of (x_i1 … x_ik), discretized on the associated grid</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only 1 or 2 dimensional marginals supported. Order matters:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_marginal_on_grid</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="n">get_marginal_on_grid</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>marginals</strong> (<em>int</em><em> | </em><em>Tuple</em><em>[</em><em>int</em><em>] </em><em>| </em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – indices of marginals to compute</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of shape <cite>(grid.N[i])</cite> or <cite>(grid.N[i], grid.N[j])</cite> — density of the marginal distribution of x_i, discretized on the associated grid</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.DistributionOnGrid.log_density">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">log_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#DistributionOnGrid.log_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.DistributionOnGrid.log_density" title="Link to this definition"></a></dt>
<dd><p>Returns a value, equal to the log pdf of the distribution (up to an additive constant).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>numpy.ndarray</em>) – array of shape <cite>(N_x, dim)</cite> — coordinates of N_x points</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of shape <cite>(N_x)</cite> — value of log density (up to an additive constant) at these points</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.DistributionOnGrid.plot_1d_marginal">
<span class="sig-name descname"><span class="pre">plot_1d_marginal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_marginal</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">plot_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">plot_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#DistributionOnGrid.plot_1d_marginal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.DistributionOnGrid.plot_1d_marginal" title="Link to this definition"></a></dt>
<dd><p>Plots marginal distributions of <cite>x_i</cite> for <cite>i = 1..dim</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_marginal</strong> (<em>int</em>) – index of marginal to plot</p></li>
<li><p><strong>fig_and_axs</strong> (<em>Tuple</em><em>[</em><em>plt.Figure</em><em>, </em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – figure and axis to plot</p></li>
<li><p><strong>axs</strong> (<em>matplotlib.pyplot.Axes</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>figure and axes with the plot</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[plt.Figure, plt.Axes]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.DistributionOnGrid.plot_2d_marginal">
<span class="sig-name descname"><span class="pre">plot_2d_marginal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">marginals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">typing.Tuple[int,</span> <span class="pre">int]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">contour_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">contour_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#DistributionOnGrid.plot_2d_marginal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.DistributionOnGrid.plot_2d_marginal" title="Link to this definition"></a></dt>
<dd><p>Plots distribution of 2-d marginals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>marginals</strong> – indices of marginals to plot</p></li>
<li><p><strong>axs</strong> – plt.Axes to plot; if <cite>None</cite>, will be initialized</p></li>
<li><p><strong>fill</strong> – if <cite>True</cite>, uses <cite>plt.contourf</cite>; default <cite>plt.contour</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.DistributionOnGrid.plot_matrix_marginals">
<span class="sig-name descname"><span class="pre">plot_matrix_marginals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_subset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_ticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contour_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contour_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scatter_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scatter_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#DistributionOnGrid.plot_matrix_marginals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.DistributionOnGrid.plot_matrix_marginals" title="Link to this definition"></a></dt>
<dd><p>Plots 1- and 2-dimensional marginals on a grid of dim x dim plots.</p>
<p>By default, the contorus are plotted on the upper-right triangle of the matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_subset</strong> (<em>List</em><em>[</em><em>int</em><em>] </em><em>| </em><em>None</em>) – indices of parameters to plot. if <cite>None</cite>, will plot the marginals of all the parameters</p></li>
<li><p><strong>sample</strong> (<em>numpy.ndarray</em><em> | </em><em>None</em>) – an array of shape <cite>(N_sample, dim)</cite> to be plotted on the lower left submatrix</p></li>
<li><p><strong>axs</strong> (<em>numpy.ndarray</em><em> | </em><em>None</em>) – <cite>(dim, dim)</cite> array of <cite>plt.Axes</cite> to plot on; if <cite>None</cite>, will be initialized</p></li>
<li><p><strong>sym</strong> (<em>bool</em>) – if <cite>True</cite>, additionally plot a transpose contours on the bottom left matrix.</p></li>
<li><p><strong>w_ticks</strong> (<em>bool</em>) – whether to draw ticks on the axes; <cite>False</cite> generally better for higher dimension</p></li>
<li><p><strong>w_labels</strong> (<em>bool</em>) – whether to draw axis labels</p></li>
<li><p><strong>plot_args</strong> (<em>List</em>) – will be passed to <cite>plt.plot</cite> for 1-d marginals</p></li>
<li><p><strong>plot_kwargs</strong> (<em>Dict</em>) – will be passed to <cite>plt.plot</cite> for 1-d marginals</p></li>
<li><p><strong>contour_args</strong> (<em>List</em>) – will be passed to <cite>plt.contour</cite> for 2-d marginals</p></li>
<li><p><strong>contour_kwargs</strong> (<em>Dict</em>) – will be passed to <cite>plt.contour</cite> for 2-d marginals</p></li>
<li><p><strong>scatter_args</strong> (<em>List</em>) – will be passed to <cite>plt.scatter</cite> for 2-d sample marginals</p></li>
<li><p><strong>scatter_kwargs</strong> (<em>Dict</em>) – will be passed to <cite>plt.scatter</cite> for 2-d sample marginals</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.GaussianMixture">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rJKOtt.DistributionOnGrid.</span></span><span class="sig-name descname"><span class="pre">GaussianMixture</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">means</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariances</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#GaussianMixture"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.GaussianMixture" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#rJKOtt.DistributionOnGrid.DistributionOnGrid" title="rJKOtt.DistributionOnGrid.DistributionOnGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistributionOnGrid</span></code></a></p>
<p>Gaussian Mixture distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid</strong> (<a class="reference internal" href="#rJKOtt.DistributionOnGrid.Grid" title="rJKOtt.DistributionOnGrid.Grid"><em>Grid</em></a>) – self-explanatory</p></li>
<li><p><strong>means</strong> (<em>np.ndarray</em><em> or </em><em>List</em><em>[</em><em>np.ndarray</em><em>]</em>) – means of each Gaussian components; either <cite>np.ndarray</cite> for one component or <cite>List[np.ndarray]</cite> of length equal to number of components</p></li>
<li><p><strong>covariances</strong> (<em>float</em><em> or </em><em>List</em><em>[</em><em>float</em><em>] or </em><em>List</em><em>[</em><em>np.ndarray</em><em>]</em>) – <p>covariances of each Gaussian components; can be</p>
<ul>
<li><p>A single scalar <cite>c</cite>. Then all the components have the same covariance matrix <cite>c*np.eye(dim)</cite></p></li>
<li><p>A list of scalars <cite>cs</cite>. Then <cite>i</cite>-th component has covariance matrix <cite>cs[i]*np.eye(dim)</cite></p></li>
<li><p>A list of <cite>np.ndarray</cite>. Then each of them should be an SPD matrix.</p></li>
</ul>
</p></li>
<li><p><strong>weights</strong> (<em>np.ndarray</em><em> or </em><em>None</em>) – positive weights for each component.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.GaussianMixture.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><a class="headerlink" href="#rJKOtt.DistributionOnGrid.GaussianMixture.dim" title="Link to this definition"></a></dt>
<dd><p>dimension of the distribution</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.GaussianMixture.covariances">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">covariances</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#rJKOtt.DistributionOnGrid.GaussianMixture.covariances" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.GaussianMixture.get_marginal_on_grid">
<span class="sig-name descname"><span class="pre">get_marginal_on_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">marginals</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#GaussianMixture.get_marginal_on_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.GaussianMixture.get_marginal_on_grid" title="Link to this definition"></a></dt>
<dd><p>Returns a density of the marginal distribution of (x_i1 … x_ik), discretized on the associated grid</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only 1 or 2 dimensional marginals supported. Order matters:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_marginal_on_grid</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="n">get_marginal_on_grid</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>marginals</strong> – indices of marginals to compute</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of shape <cite>(grid.N[i])</cite> or <cite>(grid.N[i], grid.N[j])</cite> — density of the marginal distribution of x_i, discretized on the associated grid</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.GaussianMixture.log_density">
<span class="sig-name descname"><span class="pre">log_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#GaussianMixture.log_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.GaussianMixture.log_density" title="Link to this definition"></a></dt>
<dd><p>Returns a value, equal to the log pdf of the distribution (up to an additive constant).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>numpy.ndarray</em>) – array of shape <cite>(N_x, dim)</cite> — coordinates of N_x points</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of shape <cite>(N_x)</cite> — value of log density (up to an additive constant) at these points</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.GaussianMixture.means">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">means</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#rJKOtt.DistributionOnGrid.GaussianMixture.means" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.GaussianMixture.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#GaussianMixture.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.GaussianMixture.sample" title="Link to this definition"></a></dt>
<dd><p>Sample from the Gaussian Mixture distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_samples</strong> (<em>int</em>) – number of samples</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.GaussianMixture.weights">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">weights</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#rJKOtt.DistributionOnGrid.GaussianMixture.weights" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.Grid">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rJKOtt.DistributionOnGrid.</span></span><span class="sig-name descname"><span class="pre">Grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#Grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.Grid" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Represents uniform rectangular grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>List</em><em>[</em><em>float</em><em>]</em><em>]</em>) – Left extent for the grid in each dimension</p></li>
<li><p><strong>right</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>List</em><em>[</em><em>float</em><em>]</em><em>]</em>) – Right extent for the grid in each dimension</p></li>
<li><p><strong>N_nodes</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>List</em><em>[</em><em>int</em><em>]</em><em>]</em>) – number of nodes in each dimension</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – dimension of the distribution</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Attributes :</dt><dd><p>dim : dimension of the grid</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.Grid.clip_sample">
<span class="sig-name descname"><span class="pre">clip_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#Grid.clip_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.Grid.clip_sample" title="Link to this definition"></a></dt>
<dd><p>Given an array of points, delete those of them that are out of the grid’s span</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xs</strong> (<em>numpy.ndarray</em>) – the points; should have shape <cite>(N_points, dim)</cite></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>fitting points</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.Grid.get_1d_grid">
<span class="sig-name descname"><span class="pre">get_1d_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#Grid.get_1d_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.Grid.get_1d_grid" title="Link to this definition"></a></dt>
<dd><p>Return grid points in i-th dimension</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>i</strong> (<em>int</em>) – index of the dimension; <cite>0 &lt;= i &lt; dim</cite></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of shape <cite>(grid.N[i])</cite> — grid points in i-th direction</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.Grid.get_2d_grid">
<span class="sig-name descname"><span class="pre">get_2d_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#Grid.get_2d_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.Grid.get_2d_grid" title="Link to this definition"></a></dt>
<dd><p>Return grid points in i-th dimension</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<em>int</em>) – index of the first dimension; <cite>0 &lt;= i &lt; dim</cite></p></li>
<li><p><strong>j</strong> (<em>int</em>) – index of the second dimension; <cite>0 &lt;= j &lt; dim</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>arrays of shape <cite>(N_nodes[i], N_nodes[j])</cite> (suitable for scatter plot)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.TensorTrainDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rJKOtt.DistributionOnGrid.</span></span><span class="sig-name descname"><span class="pre">TensorTrainDistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_tt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#TensorTrainDistribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.TensorTrainDistribution" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#rJKOtt.DistributionOnGrid.DistributionOnGrid" title="rJKOtt.DistributionOnGrid.DistributionOnGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistributionOnGrid</span></code></a></p>
<p>Distribution with density on grid stored in the compressed TT format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid</strong> (<a class="reference internal" href="#rJKOtt.DistributionOnGrid.Grid" title="rJKOtt.DistributionOnGrid.Grid"><em>Grid</em></a>) – self-explanatory</p></li>
<li><p><strong>rho_tt</strong> (<em>tt_vector</em>) – Tensor Train decomposition of the density on grid</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.TensorTrainDistribution.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><a class="headerlink" href="#rJKOtt.DistributionOnGrid.TensorTrainDistribution.dim" title="Link to this definition"></a></dt>
<dd><p>dimension of the distribution</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.TensorTrainDistribution.adapt_by_gaussian">
<span class="sig-name descname"><span class="pre">adapt_by_gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interval_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.997</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_new</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#TensorTrainDistribution.adapt_by_gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.TensorTrainDistribution.adapt_by_gaussian" title="Link to this definition"></a></dt>
<dd><p>Adapts the grid do be a minimal interval containing <cite>interval_prob</cite> of the distribution in each direction.
Returns a new distribution, which is a product of independent Gaussians, with same mean and covariance in each direction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interval_prob</strong> (<em>np.float64</em>) – the fraction (from <cite>0</cite> to <cite>1.0</cite>) of the distribution</p></li>
<li><p><strong>N_new</strong> – number of nodes in the new grid</p></li>
<li><p><strong>return_params</strong> (<em>bool</em>) – if <cite>True</cite>, return also mean and sigmas of the new distribution</p></li>
<li><p><strong>self</strong> (<em>rJKOtt.TensorTrainDistribution</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a new distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#rJKOtt.DistributionOnGrid.TensorTrainDistribution" title="rJKOtt.DistributionOnGrid.TensorTrainDistribution">TensorTrainDistribution</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.TensorTrainDistribution.adapt_by_interpolation">
<span class="sig-name descname"><span class="pre">adapt_by_interpolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interval_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_new</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#TensorTrainDistribution.adapt_by_interpolation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.TensorTrainDistribution.adapt_by_interpolation" title="Link to this definition"></a></dt>
<dd><p>Adapts the grid do be a minimal interval containing <cite>interval_prob</cite> of the distribution in each direction. Returns the distribution, obtained by a linear interpolation of the distribution to the new grid (a TT with same ranks).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interval_prob</strong> (<em>np.float64</em>) – the fraction (from <cite>0</cite> to <cite>1.0</cite>) of the distribution</p></li>
<li><p><strong>N_new</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>List</em><em>[</em><em>int</em><em>]</em><em>]</em>) – number of nodes in the new grid</p></li>
<li><p><strong>self</strong> (<em>rJKOtt.TensorTrainDistribution</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a new distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#rJKOtt.DistributionOnGrid.TensorTrainDistribution" title="rJKOtt.DistributionOnGrid.TensorTrainDistribution">TensorTrainDistribution</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.TensorTrainDistribution.adapt_grid">
<span class="sig-name descname"><span class="pre">adapt_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interval_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_new</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#TensorTrainDistribution.adapt_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.TensorTrainDistribution.adapt_grid" title="Link to this definition"></a></dt>
<dd><p>Adapts the grid do be a minimal interval containing <cite>interval_prob</cite> of the distribution in each direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interval_prob</strong> (<em>numpy.float64</em>) – the fraction (from <cite>0</cite> to <cite>1.0</cite>) of the distribution</p></li>
<li><p><strong>N_new</strong> – number of nodes in the new grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a new grid</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#rJKOtt.DistributionOnGrid.Grid" title="rJKOtt.DistributionOnGrid.Grid">Grid</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.TensorTrainDistribution.density">
<span class="sig-name descname"><span class="pre">density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#TensorTrainDistribution.density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.TensorTrainDistribution.density" title="Link to this definition"></a></dt>
<dd><p>Returns a value, proportional to the pdf of the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>np.ndarray</em>) – array of shape <cite>(N_x, dim)</cite> — coordinates of N_x points</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of shape <cite>(N_x)</cite> — value of density (up to normalization constant) at these points</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.TensorTrainDistribution.gaussian">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#TensorTrainDistribution.gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.TensorTrainDistribution.gaussian" title="Link to this definition"></a></dt>
<dd><p>A TT approximation of the density of the distribution with each parameter being independent and distributed as</p>
<div class="math notranslate nohighlight">
\[x_i \sim \mathcal{N}(m_i, \sigma_i),\ i = \overline{1,\ d}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid</strong> (<a class="reference internal" href="#rJKOtt.DistributionOnGrid.Grid" title="rJKOtt.DistributionOnGrid.Grid"><em>Grid</em></a>) – the grid to discretize on</p></li>
<li><p><strong>ms</strong> (<em>float</em><em> | </em><em>List</em><em>[</em><em>float</em><em>] </em><em>| </em><em>numpy.ndarray</em>) – means <span class="math notranslate nohighlight">\(m_i\)</span> of each parameter</p></li>
<li><p><strong>sigmas</strong> (<em>float</em><em> | </em><em>List</em><em>[</em><em>float</em><em>] </em><em>| </em><em>numpy.ndarray</em>) – standard deviations <span class="math notranslate nohighlight">\(sigma_i\)</span> of each parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#rJKOtt.DistributionOnGrid.TensorTrainDistribution" title="rJKOtt.DistributionOnGrid.TensorTrainDistribution">TensorTrainDistribution</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.TensorTrainDistribution.get_credible_interval">
<span class="sig-name descname"><span class="pre">get_credible_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#TensorTrainDistribution.get_credible_interval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.TensorTrainDistribution.get_credible_interval" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<em>int</em>)</p></li>
<li><p><strong>prob</strong> (<em>float</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.TensorTrainDistribution.get_marginal_on_grid">
<span class="sig-name descname"><span class="pre">get_marginal_on_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">marginals</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#TensorTrainDistribution.get_marginal_on_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.TensorTrainDistribution.get_marginal_on_grid" title="Link to this definition"></a></dt>
<dd><p>Returns a density of the marginal distribution of (x_i1 … x_ik), discretized on the associated grid</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only 1 or 2 dimensional marginals supported. Order matters:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_marginal_on_grid</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="n">get_marginal_on_grid</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>marginals</strong> – indices of marginals to compute</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of shape <cite>(grid.N[i])</cite> or <cite>(grid.N[i], grid.N[j])</cite> — density of the marginal distribution of x_i, discretized on the associated grid</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.TensorTrainDistribution.interpolate">
<span class="sig-name descname"><span class="pre">interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_grid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#TensorTrainDistribution.interpolate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.TensorTrainDistribution.interpolate" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>new_grid</strong> (<a class="reference internal" href="#rJKOtt.DistributionOnGrid.Grid" title="rJKOtt.DistributionOnGrid.Grid"><em>Grid</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#rJKOtt.DistributionOnGrid.TensorTrainDistribution" title="rJKOtt.DistributionOnGrid.TensorTrainDistribution"><em>TensorTrainDistribution</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.TensorTrainDistribution.log_density">
<span class="sig-name descname"><span class="pre">log_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#TensorTrainDistribution.log_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.TensorTrainDistribution.log_density" title="Link to this definition"></a></dt>
<dd><p>Returns a value, equal to the log pdf of the distribution (up to an additive constant).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>numpy.ndarray</em>) – array of shape <cite>(N_x, dim)</cite> — coordinates of N_x points</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array of shape <cite>(N_x)</cite> — value of log density (up to an additive constant) at these points</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.TensorTrainDistribution.rank1_fx">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rank1_fx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fns</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#TensorTrainDistribution.rank1_fx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.TensorTrainDistribution.rank1_fx" title="Link to this definition"></a></dt>
<dd><p>Convenience function to create a rank-1 TT with components</p>
<div class="math notranslate nohighlight">
\[A^i_{1k1} = f^i(x_{i,k}),\ i = \overline{1,\ d}\]</div>
<p>where <span class="math notranslate nohighlight">\(x_{i,k},\ k = \overline{1, N_i}\)</span> is the unidimensional grid in i-th direction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid</strong> (<a class="reference internal" href="#rJKOtt.DistributionOnGrid.Grid" title="rJKOtt.DistributionOnGrid.Grid"><em>Grid</em></a>) – the grid to discretize on</p></li>
<li><p><strong>fns</strong> (<em>List</em><em>[</em><em>Callable</em><em>] </em><em>| </em><em>Callable</em>) – functions <span class="math notranslate nohighlight">\(f^i\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#rJKOtt.DistributionOnGrid.TensorTrainDistribution" title="rJKOtt.DistributionOnGrid.TensorTrainDistribution">TensorTrainDistribution</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.TensorTrainDistribution.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#TensorTrainDistribution.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.TensorTrainDistribution.score" title="Link to this definition"></a></dt>
<dd><p>Note: docstring TBD</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>numpy.nda</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.tt_on_grid_grad_of_log">
<span class="sig-prename descclassname"><span class="pre">rJKOtt.DistributionOnGrid.</span></span><span class="sig-name descname"><span class="pre">tt_on_grid_grad_of_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-40</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#tt_on_grid_grad_of_log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.tt_on_grid_grad_of_log" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em>)</p></li>
<li><p><strong>F</strong> (<em>List</em><em>[</em><em>numpy.ndarray</em><em>]</em>)</p></li>
<li><p><strong>grid</strong> (<a class="reference internal" href="#rJKOtt.DistributionOnGrid.Grid" title="rJKOtt.DistributionOnGrid.Grid"><em>Grid</em></a>)</p></li>
<li><p><strong>zero_threshold</strong> (<em>numpy.float64</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.tt_on_grid_interpolate">
<span class="sig-prename descclassname"><span class="pre">rJKOtt.DistributionOnGrid.</span></span><span class="sig-name descname"><span class="pre">tt_on_grid_interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#tt_on_grid_interpolate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.tt_on_grid_interpolate" title="Link to this definition"></a></dt>
<dd><p>Assuming that <cite>F</cite> is the TT approximation of values of some function in the grid points <cite>grid</cite>, evaluate values of this function at points <cite>x</cite> by linear interpolation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – array of points, where the function is to be evaluated. Should be of shape <cite>(N_points, dim)</cite></p></li>
<li><p><strong>F</strong> (<em>List</em><em>[</em><em>numpy.ndarray</em><em>]</em>) – representation of the function values in TT format</p></li>
<li><p><strong>grid</strong> (<a class="reference internal" href="#rJKOtt.DistributionOnGrid.Grid" title="rJKOtt.DistributionOnGrid.Grid"><em>Grid</em></a>) – grid where <cite>F</cite> is defined</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>values of <cite>F</cite> at <cite>x</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rJKOtt.DistributionOnGrid.tt_on_grid_value_and_gradient">
<span class="sig-prename descclassname"><span class="pre">rJKOtt.DistributionOnGrid.</span></span><span class="sig-name descname"><span class="pre">tt_on_grid_value_and_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rJKOtt/DistributionOnGrid.html#tt_on_grid_value_and_gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rJKOtt.DistributionOnGrid.tt_on_grid_value_and_gradient" title="Link to this definition"></a></dt>
<dd><p>Assuming that <cite>F</cite> is the TT approximation of values of some function in the grid points <cite>grid</cite>, evaluate its value and gradien at points <cite>x</cite> by linear interpolation of the gunction and piecewise-constant interpolation of the gradient.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – array of points, where the function is to be evaluated. Should be of shape <cite>(N_points, dim)</cite></p></li>
<li><p><strong>F</strong> (<em>List</em><em>[</em><em>numpy.ndarray</em><em>]</em>) – representation of the function values in TT format</p></li>
<li><p><strong>grid</strong> (<a class="reference internal" href="#rJKOtt.DistributionOnGrid.Grid" title="rJKOtt.DistributionOnGrid.Grid"><em>Grid</em></a>) – grid where <cite>F</cite> is defined</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>values of <cite>F</cite> and <cite>nabla F</cite> at <cite>x</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(np.ndarray, np.ndarray)</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="rJKOtt.html" class="btn btn-neutral float-left" title="rJKOtt package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="rJKOtt.TensorTrainSolver.html" class="btn btn-neutral float-right" title="rJKOtt.TensorTrainSolver module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Vitalii Aksenov.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>